
pipeline {
agent {label 'merlin'}
    stages {
        stage ("build-local-blaze") {
            steps {
                 dir("ws-blaze") {
		              checkout scm
                 script {
                        sh "rm -rf release"
                        sh "mkdir release"
                        dir("release"){
                            sh "cp /curr/limark/genome-release/build/common/tools/bin/sdaccel.ini /curr/limark/falcon2/blaze/bin"
                            sh "source /curr/software/util/modules-tcl/init/bash"
                            sh "module load sdx/17.4; cmake -DCMAKE_BUILD_TYPE=Release -DRELEASE_VERSION=Internal on AWS -DDEPLOYMENT_DST=aws -DCMAKE_INSTALL_PREFIX=/curr/limark/falcon2/blaze .. "
                            sh "make -j 8; make test"
//			    sh "make test"
                            sh "make install"
                            
                            }
                        }
//                    }
                }
            }
        }
    }
